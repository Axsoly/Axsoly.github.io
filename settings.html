<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Settings - Art Showcase</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
  <style>
    /* Prevent page scroll behind modal if needed */
    body.modal-open {
      overflow: hidden;
    }
  </style>
</head>
<body class="bg-white dark:bg-black text-purple-900 dark:text-purple-200 min-h-screen flex flex-col items-center py-8">

<header class="flex justify-between items-center w-full max-w-4xl p-4 bg-purple-700 dark:bg-black shadow-md rounded mb-8">
  <a href="{{ url_for('profile') }}" class="text-white font-semibold hover:underline">‚Üê Back to Profile</a>
  <h1 class="text-2xl font-bold text-white">Settings</h1>
  <!-- Dark Mode Toggle Button -->
  <button id="dark-mode-toggle" aria-label="Toggle dark mode"
    class="p-2 rounded bg-purple-300 dark:bg-purple-700 text-purple-900 dark:text-purple-200 hover:bg-purple-400 dark:hover:bg-purple-600 transition">
    <svg id="icon-light" class="w-6 h-6 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10 4.5a5.5 5.5 0 1 1 0 11 5.5 5.5 0 0 1 0-11z" />
    </svg>
    <svg id="icon-dark" class="w-6 h-6 hidden dark:block" fill="currentColor" viewBox="0 0 24 24">
      <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z" />
    </svg>
  </button>
</header>

<main class="max-w-xl w-full p-6 bg-purple-100 dark:bg-purple-900 rounded-lg shadow-md">

  <!-- Change Password Form -->
  <section class="mb-8">
    <h2 class="text-xl font-bold mb-4 text-purple-700 dark:text-purple-300">Change Password</h2>
    <form method="POST" action="{{ url_for('change_password') }}" class="space-y-4">
      <div>
        <label for="current_password" class="block mb-1 font-semibold text-purple-800 dark:text-purple-300">Current Password</label>
        <input type="password" id="current_password" name="current_password" required
          class="w-full rounded border border-purple-400 dark:border-purple-700 px-3 py-2 bg-white dark:bg-purple-950 text-purple-900 dark:text-purple-200 focus:outline-none focus:ring-2 focus:ring-purple-400" />
      </div>
      <div>
        <label for="new_password" class="block mb-1 font-semibold text-purple-800 dark:text-purple-300">New Password</label>
        <input type="password" id="new_password" name="new_password" required
          class="w-full rounded border border-purple-400 dark:border-purple-700 px-3 py-2 bg-white dark:bg-purple-950 text-purple-900 dark:text-purple-200 focus:outline-none focus:ring-2 focus:ring-purple-400" />
      </div>
      <div>
        <label for="confirm_password" class="block mb-1 font-semibold text-purple-800 dark:text-purple-300">Confirm New Password</label>
        <input type="password" id="confirm_password" name="confirm_password" required
          class="w-full rounded border border-purple-400 dark:border-purple-700 px-3 py-2 bg-white dark:bg-purple-950 text-purple-900 dark:text-purple-200 focus:outline-none focus:ring-2 focus:ring-purple-400" />
      </div>
      <button type="submit"
        class="bg-purple-600 hover:bg-purple-700 text-white px-5 py-2 rounded font-semibold transition w-full">
        Change Password
      </button>
    </form>
  </section>

  <!-- Delete Account Section -->
  <section class="border-t border-purple-300 dark:border-purple-700 pt-6">
    <h2 class="text-xl font-bold mb-4 text-red-600 dark:text-red-400">Delete Account</h2>
    <p class="mb-4 text-purple-700 dark:text-purple-300">
      This action is irreversible. Your account and all your content will be permanently deleted.
    </p>
    <form method="POST" action="{{ url_for('delete_account') }}" onsubmit="return confirm('Are you sure you want to delete your account? This cannot be undone.')">
      <button type="submit"
        class="bg-red-600 hover:bg-red-700 text-white px-5 py-2 rounded font-semibold transition w-full">
        Delete My Account
      </button>
    </form>
  </section>
</main>

<script>
  const toggleButton = document.getElementById('dark-mode-toggle');
  const htmlElement = document.documentElement;

  // Initialize dark mode from storage or system preference
  if (localStorage.getItem('theme') === 'dark' || 
      (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    htmlElement.classList.add('dark');
  } else {
    htmlElement.classList.remove('dark');
  }

  toggleButton.addEventListener('click', () => {
    htmlElement.classList.toggle('dark');
    if (htmlElement.classList.contains('dark')) {
      localStorage.setItem('theme', 'dark');
    } else {
      localStorage.setItem('theme', 'light');
    }
  });
</script>

</body>
</html>
